-- Tracking				Date			Name	Description
-- Rel-20210812			12-AUG-2021		KW		Revise DCMS
-- Rel-20210827			27-AUG-2021		AM		Revise DCMS
-- Rel-2021119			19-SEP-2021		AM		CBCAXUPISSLOG-1004
-- Rel-20211213			13-DEC-2021		AM		CBCAXUPISSLOG-884 - Remove date as cardbase report data is accumulated

DECLARE
	i_REPORT_NAME VARCHAR2(100) := 'Monthly Cardbase Report';
    i_HEADER_FIELDS_CBC CLOB;
    i_BODY_FIELDS_CBC CLOB;
    i_TRAILER_FIELDS_CBC CLOB;
    i_HEADER_FIELDS_CBS CLOB;
    i_BODY_FIELDS_CBS CLOB;
    i_TRAILER_FIELDS_CBS CLOB;
	i_BODY_QUERY CLOB;
	i_TRAILER_QUERY CLOB;
BEGIN 

-- CBC header/body/trailer fields
	i_HEADER_FIELDS_CBC := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"Bank Code","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"0010","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":2,"sectionName":"2","fieldName":"Bank Name","csvTxtLength":"54","pdfLength":"54","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CHINA BANKING CORPORATION","leftJustified":true,"padFieldLength":0},{"sequence":3,"sectionName":"3","fieldName":"File Name1","csvTxtLength":"54","pdfLength":"54","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"MONTHLY CARDBASE REPORT","leftJustified":true,"padFieldLength":0},{"sequence":4,"sectionName":"4","fieldName":"Todays Date","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TODAYS DATE ","leftJustified":true,"padFieldLength":0},{"sequence":5,"sectionName":"5","fieldName":"As of Date Value","csvTxtLength":"19","pdfLength":"19","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":6,"sectionName":"6","fieldName":"Page","csvTxtLength":"5","pdfLength":"5","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"PAGE","leftJustified":true,"padFieldLength":0},{"sequence":7,"sectionName":"7","fieldName":"Page Number","csvTxtLength":"6","pdfLength":"6","fieldType":"Number","delimiter":";","fieldFormat":"","eol":true,"leftJustified":true,"padFieldLength":0},{"sequence":8,"sectionName":"8","fieldName":"","csvTxtLength":"55","pdfLength":"55","fieldType":"String","delimiter":";","fieldFormat":"","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":9,"sectionName":"19","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":10,"sectionName":"9","fieldName":"File Name2","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"(SUMMARY)","leftJustified":true,"padFieldLength":0},{"sequence":11,"sectionName":"21","fieldName":"","csvTxtLength":"34","pdfLength":"34","fieldType":"String","delimiter":"","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":12,"sectionName":"10","fieldName":"As of Date","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"AS OF DATE ","leftJustified":true,"padFieldLength":0},{"sequence":13,"sectionName":"11","fieldName":"Report To Date","csvTxtLength":"19","pdfLength":"19","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":14,"sectionName":"12","fieldName":"REPORT ID","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","eol":true,"leftJustified":true,"padFieldLength":0,"defaultValue":""},{"sequence":15,"sectionName":"13","fieldName":"","csvTxtLength":"94","pdfLength":"94","fieldType":"String","delimiter":";","fieldFormat":"","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":16,"sectionName":"20","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":17,"sectionName":"21","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":18,"sectionName":"14","fieldName":"RunDate","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"RUNDATE","leftJustified":true,"padFieldLength":0},{"sequence":19,"sectionName":"15","fieldName":"RunDate Value","csvTxtLength":"11","pdfLength":"11","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":20,"sectionName":"16","fieldName":"Time","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TIME","leftJustified":true,"padFieldLength":0},{"sequence":21,"sectionName":"17","fieldName":"Time Value","csvTxtLength":"10","pdfLength":"10","fieldType":"Date","delimiter":";","fieldFormat":"HH:mm:ss","eol":true,"leftJustified":true,"padFieldLength":0}]');
	i_BODY_FIELDS_CBC := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"CARD TYPE","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CARD TYPE: ","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":2,"sectionName":"2","fieldName":"PRODUCT_CODE","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":3,"sectionName":"3","fieldName":"PRODUCT_NAME","csvTxtLength":"40","pdfLength":"40","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":4,"sectionName":"4","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"firstField":true},{"sequence":5,"sectionName":"5","fieldName":"BRANCH CODE","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"BRANCH","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":6,"sectionName":"6","fieldName":"BRANCH NAME","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"BRANCH NAME","bodyHeader":true},{"sequence":7,"sectionName":"7","fieldName":"fldExceedPin","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"EXCEED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":8,"sectionName":"8","fieldName":"fldUnusual","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"UNUSUAL","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":9,"sectionName":"9","fieldName":"fldActive","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"ACTIVE","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":10,"sectionName":"10","fieldName":"fldInactive","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"INACTIVE","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":11,"sectionName":"11","fieldName":"fldStolen","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"STOLEN","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":12,"sectionName":"12","fieldName":"fldLost","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"LOST","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":13,"sectionName":"13","fieldName":"fldDamaged","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"DAMAGED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":14,"sectionName":"14","fieldName":"fldBlocked","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"BLOCKED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":15,"sectionName":"15","fieldName":"fldReplaced","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"REPLACED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":16,"sectionName":"16","fieldName":"fldClosed","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CLOSED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":17,"sectionName":"17","fieldName":"fldCaptured","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CAPTURED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":18,"sectionName":"18","fieldName":"fldSuspicious","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"SUSPICIOUS","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":19,"sectionName":"19","fieldName":"TotalCount","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TOTAL","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":20,"sectionName":"20","fieldName":"CD","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CD","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":21,"sectionName":"21","fieldName":"branchName2","csvTxtLength":"35","pdfLength":"35","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":22,"sectionName":"22","fieldName":"fldExceed2","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"PIN TRIES","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":23,"sectionName":"23","fieldName":"fldUnusual2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"ACTIVITY","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":24,"sectionName":"24","fieldName":"fldActive2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":25,"sectionName":"25","fieldName":"fldInactive2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":26,"sectionName":"26","fieldName":"fldStolen2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":27,"sectionName":"27","fieldName":"fldLost2","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":28,"sectionName":"28","fieldName":"fldDamaged2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":29,"sectionName":"29","fieldName":"fldBlocked2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":30,"sectionName":"30","fieldName":"fldReplaced2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":31,"sectionName":"31","fieldName":"fldClosed2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":32,"sectionName":"32","fieldName":"fldCaptured2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"LOST","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":333,"sectionName":"33","fieldName":"fldSuspicious2","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":34,"sectionName":"34","fieldName":"TotalCount2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"COUNT","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":35,"sectionName":"35","fieldName":"BRANCH_CODE","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","firstField":true,"bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":36,"sectionName":"36","fieldName":"BRANCH_NAME","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"","bodyHeader":false},{"sequence":37,"sectionName":"37","fieldName":"EXCEED_CARDS","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":38,"sectionName":"38","fieldName":"UNUSUAL_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":39,"sectionName":"39","fieldName":"ACTIVE_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":40,"sectionName":"40","fieldName":"INACTIVE_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":41,"sectionName":"41","fieldName":"STOLEN_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":42,"sectionName":"42","fieldName":"LOST_CARDS","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":43,"sectionName":"43","fieldName":"DAMAGED_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":44,"sectionName":"44","fieldName":"BLOCKED_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":45,"sectionName":"45","fieldName":"REPLACED_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":46,"sectionName":"46","fieldName":"CLOSED_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":47,"sectionName":"47","fieldName":"CAPTURED_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":48,"sectionName":"48","fieldName":"SUSPICIOUS_CARDS","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":49,"sectionName":"49","fieldName":"TOTAL_COUNT","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false}]');
	i_TRAILER_FIELDS_CBC := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"filler1","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":2,"sectionName":"2","fieldName":"fldGrandTotal","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"GRAND TOTAL","bodyHeader":true},{"sequence":3,"sectionName":"3","fieldName":"TOTAL_EXCEED","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":4,"sectionName":"4","fieldName":"TOTAL_UNUSUAL","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":5,"sectionName":"5","fieldName":"TOTAL_ACTIVE","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":6,"sectionName":"6","fieldName":"TOTAL_INACTIVE","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":7,"sectionName":"7","fieldName":"TOTAL_STOLEN","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":8,"sectionName":"8","fieldName":"TOTAL_LOST","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":9,"sectionName":"9","fieldName":"TOTAL_DAMAGED","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":10,"sectionName":"10","fieldName":"TOTAL_BLOCKED","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":11,"sectionName":"11","fieldName":"TOTAL_REPLACED","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":12,"sectionName":"12","fieldName":"TOTAL_CLOSED","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":13,"sectionName":"13","fieldName":"TOTAL_CAPTURED","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":14,"sectionName":"14","fieldName":"TOTAL_SUSPICIOUS","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":15,"sectionName":"15","fieldName":"TOTAL_TOTAL","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false}]');
	
-- CBS header/body/trailer fields
	i_HEADER_FIELDS_CBS := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"Bank Code","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"0112","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":2,"sectionName":"2","fieldName":"Bank Name","csvTxtLength":"54","pdfLength":"54","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CHINA BANKING SAVINGS","leftJustified":true,"padFieldLength":0},{"sequence":3,"sectionName":"3","fieldName":"File Name1","csvTxtLength":"54","pdfLength":"54","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"MONTHLY CARDBASE REPORT","leftJustified":true,"padFieldLength":0},{"sequence":4,"sectionName":"4","fieldName":"Todays Date","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TODAYS DATE ","leftJustified":true,"padFieldLength":0},{"sequence":5,"sectionName":"5","fieldName":"As of Date Value","csvTxtLength":"19","pdfLength":"19","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":6,"sectionName":"6","fieldName":"Page","csvTxtLength":"5","pdfLength":"5","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"PAGE","leftJustified":true,"padFieldLength":0},{"sequence":7,"sectionName":"7","fieldName":"Page Number","csvTxtLength":"6","pdfLength":"6","fieldType":"Number","delimiter":";","fieldFormat":"","eol":true,"leftJustified":true,"padFieldLength":0},{"sequence":8,"sectionName":"8","fieldName":"","csvTxtLength":"55","pdfLength":"55","fieldType":"String","delimiter":";","fieldFormat":"","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":9,"sectionName":"19","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":10,"sectionName":"9","fieldName":"File Name2","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"(SUMMARY)","leftJustified":true,"padFieldLength":0},{"sequence":11,"sectionName":"21","fieldName":"","csvTxtLength":"34","pdfLength":"34","fieldType":"String","delimiter":"","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":12,"sectionName":"10","fieldName":"As of Date","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"AS OF DATE ","leftJustified":true,"padFieldLength":0},{"sequence":13,"sectionName":"11","fieldName":"Report To Date","csvTxtLength":"19","pdfLength":"19","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":14,"sectionName":"12","fieldName":"REPORT ID","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","eol":true,"leftJustified":true,"padFieldLength":0,"defaultValue":""},{"sequence":15,"sectionName":"13","fieldName":"","csvTxtLength":"94","pdfLength":"94","fieldType":"String","delimiter":";","fieldFormat":"","firstField":true,"leftJustified":true,"padFieldLength":0},{"sequence":16,"sectionName":"20","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":17,"sectionName":"21","fieldName":"","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0},{"sequence":18,"sectionName":"14","fieldName":"RunDate","csvTxtLength":"15","pdfLength":"15","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"RUNDATE","leftJustified":true,"padFieldLength":0},{"sequence":19,"sectionName":"15","fieldName":"RunDate Value","csvTxtLength":"11","pdfLength":"11","fieldType":"Date","delimiter":";","fieldFormat":"MM/dd/yy","leftJustified":true,"padFieldLength":0},{"sequence":20,"sectionName":"16","fieldName":"Time","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TIME","leftJustified":true,"padFieldLength":0},{"sequence":21,"sectionName":"17","fieldName":"Time Value","csvTxtLength":"10","pdfLength":"10","fieldType":"Date","delimiter":";","fieldFormat":"HH:mm:ss","eol":true,"leftJustified":true,"padFieldLength":0}]');
	i_BODY_FIELDS_CBS := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"CARD TYPE","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CARD TYPE: ","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":2,"sectionName":"2","fieldName":"PRODUCT_CODE","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":3,"sectionName":"3","fieldName":"PRODUCT_NAME","csvTxtLength":"40","pdfLength":"40","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":4,"sectionName":"4","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"firstField":true},{"sequence":5,"sectionName":"5","fieldName":"BRANCH CODE","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"BRANCH","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":6,"sectionName":"6","fieldName":"BRANCH NAME","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"BRANCH NAME","bodyHeader":true},{"sequence":7,"sectionName":"7","fieldName":"fldExceedPin","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"EXCEED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":8,"sectionName":"8","fieldName":"fldUnusual","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"UNUSUAL","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":9,"sectionName":"9","fieldName":"fldActive","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"ACTIVE","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":10,"sectionName":"10","fieldName":"fldInactive","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"INACTIVE","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":11,"sectionName":"11","fieldName":"fldStolen","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"STOLEN","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":12,"sectionName":"12","fieldName":"fldLost","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"LOST","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":13,"sectionName":"13","fieldName":"fldDamaged","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"DAMAGED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":14,"sectionName":"14","fieldName":"fldBlocked","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"BLOCKED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":15,"sectionName":"15","fieldName":"fldReplaced","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"REPLACED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":16,"sectionName":"16","fieldName":"fldClosed","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CLOSED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":17,"sectionName":"17","fieldName":"fldCaptured","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CAPTURED","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":18,"sectionName":"18","fieldName":"fldSuspicious","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"SUSPICIOUS","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":19,"sectionName":"19","fieldName":"TotalCount","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"TOTAL","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":20,"sectionName":"20","fieldName":"CD","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"CD","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":21,"sectionName":"21","fieldName":"branchName2","csvTxtLength":"35","pdfLength":"35","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":22,"sectionName":"22","fieldName":"fldExceed2","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"PIN TRIES","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":23,"sectionName":"23","fieldName":"fldUnusual2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"ACTIVITY","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":24,"sectionName":"24","fieldName":"fldActive2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":25,"sectionName":"25","fieldName":"fldInactive2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":26,"sectionName":"26","fieldName":"fldStolen2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":27,"sectionName":"27","fieldName":"fldLost2","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":28,"sectionName":"28","fieldName":"fldDamaged2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":29,"sectionName":"29","fieldName":"fldBlocked2","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":30,"sectionName":"30","fieldName":"fldReplaced2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":31,"sectionName":"31","fieldName":"fldClosed2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":32,"sectionName":"32","fieldName":"fldCaptured2","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"LOST","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":333,"sectionName":"33","fieldName":"fldSuspicious2","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":34,"sectionName":"34","fieldName":"TotalCount2","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"COUNT","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":35,"sectionName":"35","fieldName":"BRANCH_CODE","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","firstField":true,"bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":36,"sectionName":"36","fieldName":"BRANCH_NAME","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"","bodyHeader":false},{"sequence":37,"sectionName":"37","fieldName":"EXCEED_CARDS","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":38,"sectionName":"38","fieldName":"UNUSUAL_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":39,"sectionName":"39","fieldName":"ACTIVE_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":40,"sectionName":"40","fieldName":"INACTIVE_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":41,"sectionName":"41","fieldName":"STOLEN_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":42,"sectionName":"42","fieldName":"LOST_CARDS","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":43,"sectionName":"43","fieldName":"DAMAGED_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":44,"sectionName":"44","fieldName":"BLOCKED_CARDS","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":45,"sectionName":"45","fieldName":"REPLACED_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":46,"sectionName":"46","fieldName":"CLOSED_CARDS","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":47,"sectionName":"47","fieldName":"CAPTURED_CARDS","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":48,"sectionName":"48","fieldName":"SUSPICIOUS_CARDS","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":49,"sectionName":"49","fieldName":"TOTAL_COUNT","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":false,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false}]');
	i_TRAILER_FIELDS_CBS := TO_CLOB('[{"sequence":1,"sectionName":"1","fieldName":"filler1","csvTxtLength":"7","pdfLength":"7","fieldType":"String","delimiter":";","fieldFormat":"","defaultValue":"","firstField":true,"bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":2,"sectionName":"2","fieldName":"fldGrandTotal","fieldType":"String","delimiter":";","fieldFormat":"","leftJustified":true,"padFieldLength":0,"decrypt":false,"csvTxtLength":"35","pdfLength":"35","defaultValue":"GRAND TOTAL","bodyHeader":true},{"sequence":3,"sectionName":"3","fieldName":"TOTAL_EXCEED","csvTxtLength":"11","pdfLength":"11","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":4,"sectionName":"4","fieldName":"TOTAL_UNUSUAL","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":5,"sectionName":"5","fieldName":"TOTAL_ACTIVE","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":6,"sectionName":"6","fieldName":"TOTAL_INACTIVE","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false},{"sequence":7,"sectionName":"7","fieldName":"TOTAL_STOLEN","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":8,"sectionName":"8","fieldName":"TOTAL_LOST","csvTxtLength":"6","pdfLength":"6","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":9,"sectionName":"9","fieldName":"TOTAL_DAMAGED","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":10,"sectionName":"10","fieldName":"TOTAL_BLOCKED","csvTxtLength":"9","pdfLength":"9","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":11,"sectionName":"11","fieldName":"TOTAL_REPLACED","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":12,"sectionName":"12","fieldName":"TOTAL_CLOSED","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":13,"sectionName":"13","fieldName":"TOTAL_CAPTURED","csvTxtLength":"10","pdfLength":"10","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":14,"sectionName":"14","fieldName":"TOTAL_SUSPICIOUS","csvTxtLength":"12","pdfLength":"12","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"leftJustified":true,"padFieldLength":0,"decrypt":false,"eol":false},{"sequence":15,"sectionName":"15","fieldName":"TOTAL_TOTAL","csvTxtLength":"8","pdfLength":"8","fieldType":"String","delimiter":";","fieldFormat":"","bodyHeader":true,"eol":true,"leftJustified":true,"padFieldLength":0,"decrypt":false}]');


	i_BODY_QUERY := TO_CLOB('		
select 
  PRODUCT_CODE,
  PRODUCT_NAME,
  BRANCH_CODE,
  BRANCH_NAME,
  SUM(EXCEED_CARDS) AS EXCEED_CARDS,
  SUM(UNUSUAL_CARDS) AS UNUSUAL_CARDS,
  SUM(ACTIVE_CARDS) AS ACTIVE_CARDS,
  SUM(INACTIVE_CARDS) AS INACTIVE_CARDS,
  SUM(STOLEN_CARDS) AS STOLEN_CARDS,
  SUM(LOST_CARDS) AS LOST_CARDS,
  SUM(DAMAGED_CARDS) AS DAMAGED_CARDS,
  SUM(BLOCKED_CARDS) AS BLOCKED_CARDS,
  SUM(REPLACED_CARDS) AS REPLACED_CARDS,
  SUM(CLOSED_CARDS) AS CLOSED_CARDS,
  SUM(CAPTURED_CARDS) AS CAPTURED_CARDS,
  SUM(SUSPICIOUS_CARDS) AS SUSPICIOUS_CARDS,
  SUM(EXCEED_CARDS) + SUM(UNUSUAL_CARDS) + SUM(ACTIVE_CARDS) + SUM(INACTIVE_CARDS) + SUM(STOLEN_CARDS) + SUM(LOST_CARDS) + SUM(DAMAGED_CARDS) + SUM(BLOCKED_CARDS) + SUM(REPLACED_CARDS) + SUM(CLOSED_CARDS) + SUM(CAPTURED_CARDS) + SUM(SUSPICIOUS_CARDS) AS TOTAL_COUNT
FROM(
select 
  PRS.PRS_CODE AS PRODUCT_CODE,
  PRS.PRS_NAME AS PRODUCT_NAME,
  BRN.BRN_CODE as BRANCH_CODE,
  BRN.BRN_NAME as BRANCH_NAME,
  0 AS EXCEED_CARDS,
  0 AS UNUSUAL_CARDS,
  CASE WHEN CRD_STS_ID = 72 THEN 1 ELSE 0 END AS ACTIVE_CARDS,
  CASE WHEN CRD_STS_ID = 71 THEN 1 ELSE 0 END AS INACTIVE_CARDS,
  CASE WHEN CRD_STS_ID = 78 THEN 1 ELSE 0 END AS STOLEN_CARDS,
  CASE WHEN CRD_STS_ID = 76 THEN 1 ELSE 0 END AS LOST_CARDS,
  CASE WHEN CRD_STS_ID = 75 THEN 1 ELSE 0 END AS DAMAGED_CARDS,
  CASE WHEN CRD_STS_ID = 73 THEN 1 ELSE 0 END AS BLOCKED_CARDS,
  CASE WHEN CRD_STS_ID = 77 THEN 1 ELSE 0 END AS REPLACED_CARDS,
  CASE WHEN CRD_STS_ID = 74 THEN 1 ELSE 0 END AS CLOSED_CARDS,
  0 AS CAPTURED_CARDS,
  CASE WHEN CRD_STS_ID = 80 THEN 1 ELSE 0 END AS SUSPICIOUS_CARDS 
FROM {DCMS_Schema}.ISSUANCE_CARD@{DB_LINK_DCMS} CRD
  JOIN {DCMS_Schema}.MASTER_BRANCHES@{DB_LINK_DCMS} BRN ON BRN.BRN_ID = CRD.CRD_BRN_ID
  JOIN {DCMS_Schema}.CARD_PROGRAM_SETUP@{DB_LINK_DCMS} PRS ON PRS.PRS_ID = CRD.CRD_PRS_ID
WHERE CRD.CRD_INS_ID = 1
 -- AND trunc(COALESCE(CRD.CRD_UPDATED_TS,CRD.CRD_CREATED_TS)) < To_Date({To_Date},''dd-MM-YY hh24:mi:ss'')
UNION ALL
select 
  PRS.PRS_CODE AS PRODUCT_CODE,
  PRS.PRS_NAME AS PRODUCT_NAME,
  BRN.BRN_CODE as BRANCH_CODE,
  BRN.BRN_NAME as BRANCH_NAME,
  0 AS EXCEED_CARDS,
  0 AS UNUSUAL_CARDS,
  CASE WHEN CSH_STS_ID = 72 THEN 1 ELSE 0 END AS ACTIVE_CARDS,
  CASE WHEN CSH_STS_ID = 71 THEN 1 ELSE 0 END AS INACTIVE_CARDS,
  CASE WHEN CSH_STS_ID = 78 THEN 1 ELSE 0 END AS STOLEN_CARDS,
  CASE WHEN CSH_STS_ID = 76 THEN 1 ELSE 0 END AS LOST_CARDS,
  CASE WHEN CSH_STS_ID = 75 THEN 1 ELSE 0 END AS DAMAGED_CARDS,
  CASE WHEN CSH_STS_ID = 73 THEN 1 ELSE 0 END AS BLOCKED_CARDS,
  CASE WHEN CSH_STS_ID = 77 THEN 1 ELSE 0 END AS REPLACED_CARDS,
  CASE WHEN CSH_STS_ID = 74 THEN 1 ELSE 0 END AS CLOSED_CARDS,
  0 AS CAPTURED_CARDS,
  CASE WHEN CSH_STS_ID = 80 THEN 1 ELSE 0 END AS SUSPICIOUS_CARDS 
FROM {DCMS_Schema}.ISSUANCE_CASH_CARD@{DB_LINK_DCMS} CSH
  JOIN {DCMS_Schema}.MASTER_BRANCHES@{DB_LINK_DCMS} BRN ON BRN.BRN_ID = CSH.CSH_BRN_ID
  JOIN {DCMS_Schema}.CARD_PROGRAM_SETUP@{DB_LINK_DCMS} PRS ON PRS.PRS_ID = CSH.CSH_PRS_ID
WHERE CSH.CSH_INS_ID = {Iss_Id}
 -- AND trunc(COALESCE(CSH.CSH_UPDATED_TS,CSH.CSH_CREATED_TS)) < To_Date({To_Date},''dd-MM-YY hh24:mi:ss'')
UNION ALL
select 
  ''Z'' AS PRODUCT_CODE,
  '' '' AS PRODUCT_NAME,
  PRS.PRS_CODE as BRANCH_CODE,
  PRS.PRS_NAME as BRANCH_NAME,
  0 AS EXCEED_CARDS,
  0 AS UNUSUAL_CARDS,
  CASE WHEN CRD_STS_ID = 72 THEN 1 ELSE 0 END AS ACTIVE_CARDS,
  CASE WHEN CRD_STS_ID = 71 THEN 1 ELSE 0 END AS INACTIVE_CARDS,
  CASE WHEN CRD_STS_ID = 78 THEN 1 ELSE 0 END AS STOLEN_CARDS,
  CASE WHEN CRD_STS_ID = 76 THEN 1 ELSE 0 END AS LOST_CARDS,
  CASE WHEN CRD_STS_ID = 75 THEN 1 ELSE 0 END AS DAMAGED_CARDS,
  CASE WHEN CRD_STS_ID = 73 THEN 1 ELSE 0 END AS BLOCKED_CARDS,
  CASE WHEN CRD_STS_ID = 77 THEN 1 ELSE 0 END AS REPLACED_CARDS,
  CASE WHEN CRD_STS_ID = 74 THEN 1 ELSE 0 END AS CLOSED_CARDS,
  0 AS CAPTURED_CARDS,
  CASE WHEN CRD_STS_ID = 80 THEN 1 ELSE 0 END AS SUSPICIOUS_CARDS 
FROM {DCMS_Schema}.ISSUANCE_CARD@{DB_LINK_DCMS} CRD
  JOIN {DCMS_Schema}.MASTER_BRANCHES@{DB_LINK_DCMS} BRN ON BRN.BRN_ID = CRD.CRD_BRN_ID
  JOIN {DCMS_Schema}.CARD_PROGRAM_SETUP@{DB_LINK_DCMS} PRS ON PRS.PRS_ID = CRD.CRD_PRS_ID
WHERE CRD.CRD_INS_ID = 1
 -- AND trunc(COALESCE(CRD.CRD_UPDATED_TS,CRD.CRD_CREATED_TS)) < To_Date({To_Date},''dd-MM-YY hh24:mi:ss'')
UNION ALL
select 
  ''Z'' AS PRODUCT_CODE,
  '' '' AS PRODUCT_NAME,
  PRS.PRS_CODE as BRANCH_CODE,
  PRS.PRS_NAME as BRANCH_NAME,
  0 AS EXCEED_CARDS,
  0 AS UNUSUAL_CARDS,
  CASE WHEN CSH_STS_ID = 72 THEN 1 ELSE 0 END AS ACTIVE_CARDS,
  CASE WHEN CSH_STS_ID = 71 THEN 1 ELSE 0 END AS INACTIVE_CARDS,
  CASE WHEN CSH_STS_ID = 78 THEN 1 ELSE 0 END AS STOLEN_CARDS,
  CASE WHEN CSH_STS_ID = 76 THEN 1 ELSE 0 END AS LOST_CARDS,
  CASE WHEN CSH_STS_ID = 75 THEN 1 ELSE 0 END AS DAMAGED_CARDS,
  CASE WHEN CSH_STS_ID = 73 THEN 1 ELSE 0 END AS BLOCKED_CARDS,
  CASE WHEN CSH_STS_ID = 77 THEN 1 ELSE 0 END AS REPLACED_CARDS,
  CASE WHEN CSH_STS_ID = 74 THEN 1 ELSE 0 END AS CLOSED_CARDS,
  0 AS CAPTURED_CARDS,
  CASE WHEN CSH_STS_ID = 80 THEN 1 ELSE 0 END AS SUSPICIOUS_CARDS 
FROM {DCMS_Schema}.ISSUANCE_CASH_CARD@{DB_LINK_DCMS} CSH
  JOIN {DCMS_Schema}.MASTER_BRANCHES@{DB_LINK_DCMS} BRN ON BRN.BRN_ID = CSH.CSH_BRN_ID
  JOIN {DCMS_Schema}.CARD_PROGRAM_SETUP@{DB_LINK_DCMS} PRS ON PRS.PRS_ID = CSH.CSH_PRS_ID
WHERE CSH.CSH_INS_ID = {Iss_Id}
 -- AND trunc(COALESCE(CSH.CSH_UPDATED_TS,CSH.CSH_CREATED_TS)) < To_Date({To_Date},''dd-MM-YY hh24:mi:ss'')
) GROUP BY PRODUCT_CODE, PRODUCT_NAME, BRANCH_CODE, BRANCH_NAME
ORDER BY CASE PRODUCT_CODE WHEN ''Z'' THEN 2 ELSE 1 END, BRANCH_NAME
	');
	i_TRAILER_QUERY := null;
	
	UPDATE REPORT_DEFINITION SET 
		RED_HEADER_FIELDS = i_HEADER_FIELDS_CBC,
		RED_BODY_FIELDS = i_BODY_FIELDS_CBC,
		RED_TRAILER_FIELDS = i_TRAILER_FIELDS_CBC,
		RED_BODY_QUERY = i_BODY_QUERY,
		RED_TRAILER_QUERY = i_TRAILER_QUERY
	WHERE RED_NAME = i_REPORT_NAME AND RED_INS_ID = 22;
	
	UPDATE REPORT_DEFINITION SET 
		RED_HEADER_FIELDS = i_HEADER_FIELDS_CBS,
		RED_BODY_FIELDS = i_BODY_FIELDS_CBS,
		RED_TRAILER_FIELDS = i_TRAILER_FIELDS_CBS,
		RED_BODY_QUERY = i_BODY_QUERY,
		RED_TRAILER_QUERY = i_TRAILER_QUERY
	WHERE RED_NAME = i_REPORT_NAME AND RED_INS_ID = 2;
	
END;
/